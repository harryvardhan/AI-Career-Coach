generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"   // ⬅️ change from "sqlite" to "postgresql"
  url      = env("postgres://34503c6db35f520add3cfeed7395a8ce22dc336e64bd743e7f68579470d99cf9:sk_G4wzO7-8nksANUEZ9_MKj@db.prisma.io:5432/postgres?sslmode=require")
}


model User {
  id              String           @id @default(cuid())
  clerkUserId     String           @unique
  email           String?          @unique
  name            String?
  imageUrl        String? // ✅ Added back
  role            String?
  industry        String?
  experienceLevel String?
  currentCompany  String?
  skills          Json?
  assessments     Assessment[]
  resume          Resume?
  industryInsight IndustryInsight?
  coverLetters    CoverLetter[]
  createdAt       DateTime         @default(now())
}

model Resume {
  id      String @id @default(cuid())
  userId  String @unique
  content String // FIXED: removed @db.Text
  user    User   @relation(fields: [userId], references: [id])
}

model Assessment {
  id             String   @id @default(cuid())
  userId         String
  quizScore      Float
  category       String
  questions      Json?
  improvementTip String? // <-- ADD THIS
  createdAt      DateTime @default(now())
  user           User     @relation(fields: [userId], references: [id])
}

model IndustryInsight {
  id                String    @id @default(cuid())
  industry          String
  salaryRanges      Json?
  growthRate        Float?
  demandLevel       String?
  topSkills         Json?
  marketOutlook     String?
  keyTrends         Json?
  recommendedSkills Json?
  nextUpdate        DateTime?
  userId            String?   @unique // FIXED
  user              User?     @relation(fields: [userId], references: [id])
}

model CoverLetter {
  id             String @id @default(cuid())
  content        String
  jobDescription String
  companyName    String
  jobTitle       String
  status         String @default("completed")

  userId String
  user   User   @relation(fields: [userId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
